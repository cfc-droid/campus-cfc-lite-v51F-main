<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>An√°lisis (PAE)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Campus CSS (ruta correcta desde /tools/pea/) -->
<link rel="stylesheet" href="../../css/variables.css?v=1" />
<link rel="stylesheet" href="../../css/premium.min.css?v=1" />

<!-- PEA CSS (si los ten√≠as, dejalos tambi√©n) -->
<link rel="stylesheet" href="./css/pea_tokens.css?v=1" />
<link rel="stylesheet" href="./css/pea_layout.css?v=1" />
<link rel="stylesheet" href="./css/pea_components.css?v=1" />

<style>
  /* FIX legibilidad: crea una ‚Äútarjeta‚Äù para que el texto no quede sobre el fondo del premium */
  .pea-home{
    max-width: 980px;
    margin: 40px auto;
    padding: 22px 24px;
    border-radius: 16px;
    background: rgba(255,255,255,.88);
    color: #111;
  }
  .pea-home h1 { margin-top: 0; }
  .pea-desc, .pea-help { color: #111; }
  .pea-help li { margin: 6px 0; }

  /* Dark mode */
  html.pea-dark .pea-home{
    background: rgba(20,20,20,.78);
    color: #f3f3f3;
  }
  html.pea-dark .pea-desc,
  html.pea-dark .pea-help { color: #f3f3f3; }
</style>

  
</head>

<body class="premium-scope">
  <main class="pea-home">


    <h1>An√°lisis (PAE)</h1>

    <!-- EXPLICACI√ìN CLARA EN 5 SEGUNDOS -->
    <p class="pea-desc">
      <strong>PAE</strong> es una herramienta de registro y an√°lisis basada en
      <strong>Pensamiento ‚Äì Acci√≥n ‚Äì Emoci√≥n</strong>.
      <br />
      Su objetivo es ayudarte a <strong>detectar patrones reales</strong> de tu
      conducta operativa, <strong>sin interpretar ni aconsejar</strong>.
    </p>

    <!-- QU√â POD√âS HACER AC√Å -->
    <ul class="pea-help">
      <li><strong>Cargar registro:</strong> registrar una operaci√≥n o evento operativo.</li>
      <li><strong>Historial y estad√≠sticas:</strong> analizar registros y m√©tricas.</li>
      <li><strong>Volver al Campus:</strong> regresar al contenido principal.</li>
      <li><strong>Claro / Oscuro:</strong> cambiar el modo visual.</li>
      <li><strong>Calculo de estadisticas</strong> C√≥mo se calculan las estad√≠sticas.</li>

    </ul>

    <div class="pea-actions">

      <button id="pea-btn-register" class="btn-main">
        Cargar registro
      </button>

      <button id="pea-btn-history" class="btn-main">
        Historial y estad√≠sticas
      </button>

      <button id="pea-btn-back" class="btn-main">
        Volver al Campus
      </button>

      <button id="pea-btn-theme" class="btn-main">
        Claro / Oscuro
      </button>

<button
  id="pea-btn-metrics-info"
  class="btn-main"
  onclick="window.location.href='./pea_stats_help.html'">
  Calculo de estadisticas
</button>
      
    </div>

  </main>

  <script>
    // =========================================================
    // üîê PEA ‚Äî IDENTIDAD COMPATIBLE CON CAMPUS (NO INVASIVA)
    // - NO modifica el Campus
    // - NO crea email global
    // - SOLO consume CFC_EMAIL
    // - Genera hash exclusivo para PEA
    // =========================================================
    (function ensurePEAIdentity() {
      const email = localStorage.getItem("CFC_EMAIL");

      if (!email) {
        alert(
          "PEA no puede iniciarse.\n\n" +
          "No se detect√≥ una sesi√≥n v√°lida del Campus.\n" +
          "Por favor, ingres√° desde el Campus principal."
        );
        throw new Error("PEA BLOCKED: CFC_EMAIL no disponible");
      }

      try {
        const encoder = new TextEncoder();
        crypto.subtle
          .digest("SHA-256", encoder.encode(email))
          .then(buffer => {
            const hashArray = Array.from(new Uint8Array(buffer));
            const hashHex = hashArray
              .map(b => b.toString(16).padStart(2, "0"))
              .join("")
              .toUpperCase();

            localStorage.setItem("PEA_EMAIL_HASH", hashHex);
          });
      } catch (e) {
        console.error("PEA HASH ERROR:", e);
        throw new Error("PEA BLOCKED: fallo al generar identidad");
      }
    })();
  </script>

<script>
  // =========================================================
  // ‚úÖ PEA THEME (independiente del Campus)
  // No pisa nada global
  // =========================================================
  (function peaThemeInit(){
    const KEY = "PEA_THEME";
    const root = document.documentElement;
    const btn = document.getElementById("pea-btn-theme");

    function apply(mode){
      const dark = (mode === "dark");
      root.classList.toggle("pea-dark", dark);
      localStorage.setItem(KEY, dark ? "dark" : "light");
    }

    const saved = localStorage.getItem(KEY) || "light";
    apply(saved);

    if (btn){
      btn.addEventListener("click", () => {
        const current = localStorage.getItem(KEY) || "light";
        apply(current === "dark" ? "light" : "dark");
      });
    }
  })();
</script>

<script src="./pea_home.js"></script>

</body>
</html>
